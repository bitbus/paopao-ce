import{p as Ee,a as Ge,_ as Ye,b as Je,c as Ke}from"./content-7dbf66ba.js";import{d as ve,c as le,r as pe,e as n,f as g,k as s,al as Qe,w as o,j as c,F as oe,u as ne,y as R,bf as r,A as k,x as f,q as d,Y as m,h as G,H as u,R as Xe,b as Ze,E as ea}from"./@vue-a481fc63.js";import{u as me}from"./vuex-44de225f.js";import{u as aa,b as ta}from"./vue-router-e5a2430e.js";import{c as sa,b as la}from"./formatTime-4210fcd1.js";import{c as oa}from"./copy-to-clipboard-4ef7d3eb.js";import{i as de,j as na,l as ua,m as ia,o as ca,w as ra,x as _e,y as _a,z as va,D as pa,G as ma}from"./@vicons-9939c40b.js";import{j as I,o as fe,M as ge,e as he,O as ke,a as we,L as da,R as fa,F as ga,k as ha,f as ka,g as wa,I as ya,G as ba}from"./naive-ui-0c25505f.js";import{_ as Pa}from"./post-item.vue_vue_type_style_index_0_lang-8dc18a9d.js";import{_ as $a}from"./post-skeleton-ce58098c.js";import{W as Ta,_ as xa}from"./whisper-add-friend-6ba3ad66.js";import{D as za,e as N,E as qa,F as Ca,G as Ma,H as Ia,_ as Sa}from"./index-27f06e6c.js";import{W as Oa}from"./v3-infinite-loading-2c58ec2f.js";import"./paopao-video-player-2fe58954.js";import"./moment-2ab8298d.js";import"./@babel-725317a4.js";import"./toggle-selection-93f4ad84.js";import"./seemly-76b7b838.js";import"./vueuc-39372edb.js";import"./evtd-b614532e.js";import"./@css-render-7124a1a5.js";import"./vooks-6d99783e.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-6a5c5852.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-8412e618.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";import"./axios-4a70c6fc.js";/* empty css               */const Fa={class:"post-item"},La={class:"nickname-wrap"},Ua={class:"username-wrap"},Da={class:"timestamp-mobile"},Wa={class:"item-header-extra"},Aa=["innerHTML"],Ha={class:"opt-item"},ja={class:"opt-item"},Ba=ve({__name:"mobile-tweet-item",props:{post:{}},setup(ue){const V=ue,q=aa(),y=me(),$=i=>()=>G(I,null,{default:()=>G(i)}),p=le(()=>[{label:"复制链接",key:"copyTweetLink",icon:$(ca)}]),h=async i=>{switch(i){case"copyTweetLink":oa(`${window.location.origin}/#/post?id=${e.value.id}`),window.$message.success("链接已复制到剪贴板");break}},e=le(()=>{let i=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},V.post);return i.contents.map(t=>{(+t.type==1||+t.type==2)&&i.texts.push(t),+t.type==3&&i.imgs.push(t),+t.type==4&&i.videos.push(t),+t.type==6&&i.links.push(t),+t.type==7&&i.attachments.push(t),+t.type==8&&i.charge_attachments.push(t)}),i}),_=i=>{q.push({name:"post",query:{id:i}})},O=(i,t)=>{if(i.target.dataset.detail){const b=i.target.dataset.detail.split(":");if(b.length===2){y.commit("refresh"),b[0]==="tag"?q.push({name:"home",query:{q:b[1],t:"tag"}}):q.push({name:"user",query:{s:b[1]}});return}}_(t)};return(i,t)=>{const b=fe,F=pe("router-link"),C=ge,L=he,U=ke,P=Ge,l=Ye,T=Je,D=Ke,W=we,A=da;return n(),g("div",Fa,[s(A,{"content-indented":""},Qe({avatar:o(()=>[s(b,{round:"",size:30,src:e.value.user.avatar},null,8,["src"])]),header:o(()=>[c("span",La,[s(F,{onClick:t[0]||(t[0]=R(()=>{},["stop"])),class:"username-link",to:{name:"me",query:{s:e.value.user.username}}},{default:o(()=>[k(f(e.value.user.nickname),1)]),_:1},8,["to"])]),c("span",Ua," @"+f(e.value.user.username),1),e.value.is_top?(n(),d(C,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:o(()=>[k(" 置顶 ")]),_:1})):m("",!0),e.value.visibility==1?(n(),d(C,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:o(()=>[k(" 私密 ")]),_:1})):m("",!0),e.value.visibility==2?(n(),d(C,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:o(()=>[k(" 好友可见 ")]),_:1})):m("",!0),c("div",null,[c("span",Da,f(r(sa)(e.value.created_on))+" "+f(e.value.ip_loc),1)])]),"header-extra":o(()=>[c("div",Wa,[s(U,{placement:"bottom-end",trigger:"click",size:"small",options:p.value,onSelect:h},{default:o(()=>[s(L,{quaternary:"",circle:""},{icon:o(()=>[s(r(I),null,{default:o(()=>[s(r(de))]),_:1})]),_:1})]),_:1},8,["options"])])]),footer:o(()=>[e.value.attachments.length>0?(n(),d(P,{key:0,attachments:e.value.attachments},null,8,["attachments"])):m("",!0),e.value.charge_attachments.length>0?(n(),d(P,{key:1,attachments:e.value.charge_attachments,price:e.value.attachment_price},null,8,["attachments","price"])):m("",!0),e.value.imgs.length>0?(n(),d(l,{key:2,imgs:e.value.imgs},null,8,["imgs"])):m("",!0),e.value.videos.length>0?(n(),d(T,{key:3,videos:e.value.videos},null,8,["videos"])):m("",!0),e.value.links.length>0?(n(),d(D,{key:4,links:e.value.links},null,8,["links"])):m("",!0)]),action:o(()=>[s(W,{justify:"space-between"},{default:o(()=>[c("div",Ha,[s(r(I),{size:"18",class:"opt-item-icon"},{default:o(()=>[s(r(na))]),_:1}),k(" "+f(e.value.upvote_count),1)]),c("div",{class:"opt-item",onClick:t[3]||(t[3]=R(x=>_(e.value.id),["stop"]))},[s(r(I),{size:"18",class:"opt-item-icon"},{default:o(()=>[s(r(ua))]),_:1}),k(" "+f(e.value.comment_count),1)]),c("div",ja,[s(r(I),{size:"18",class:"opt-item-icon"},{default:o(()=>[s(r(ia))]),_:1}),k(" "+f(e.value.collection_count),1)])]),_:1})]),_:2},[e.value.texts.length>0?{name:"description",fn:o(()=>[c("div",{onClick:t[2]||(t[2]=x=>_(e.value.id))},[(n(!0),g(oe,null,ne(e.value.texts,x=>(n(),g("span",{key:x.id,class:"post-text",onClick:t[1]||(t[1]=R(H=>O(H,e.value.id),["stop"])),innerHTML:r(Ee)(x.content).content},null,8,Aa))),128))])]),key:"0"}:void 0]),1024)])}}});const Na={key:0,class:"profile-baseinfo"},Ra={class:"avatar"},Va={class:"base-info"},Ea={class:"username"},Ga={class:"userinfo"},Ya={class:"info-item"},Ja={class:"info-item"},Ka={class:"userinfo"},Qa={class:"info-item"},Xa={class:"info-item"},Za={key:0,class:"user-opts"},et={key:0,class:"skeleton-wrap"},at={key:1},tt={key:0,class:"empty-wrap"},st={key:1},lt={key:2},ot={class:"load-more-wrap"},nt={class:"load-more-spinner"},ut=ve({__name:"Me",setup(ue){const V="true".toLowerCase()==="true",q=fa(),y=me(),$=ta(),p=u(!1),h=u(!1),e=Xe({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,is_following:!1,created_on:0,follows:0,followings:0,status:1}),_=u(!1),O=u(!1),i=u(!1),t=u([]),b=u([]),F=u([]),C=u([]),L=u([]),U=u([]),P=u($.query.s||""),l=u(+$.query.p||1),T=u("post"),D=u(+$.query.p||1),W=u(1),A=u(1),x=u(1),H=u(1),w=u(20),v=u(0),Y=u(0),J=u(0),K=u(0),Q=u(0),X=u(0),ye=()=>{h.value=!1,t.value=[],b.value=[],F.value=[],C.value=[],L.value=[],U.value=[],T.value="post",l.value=1,D.value=1,W.value=1,A.value=1,x.value=1,H.value=1,v.value=0,Y.value=0,J.value=0,K.value=0,Q.value=0,X.value=0},be=()=>{switch(T.value){case"post":E();break;case"comment":Z();break;case"highlight":ee();break;case"media":ae();break;case"star":te();break}},E=()=>{p.value=!0,N({username:P.value,style:"post",page:l.value,page_size:w.value}).then(a=>{p.value=!1,a.list.length===0&&(h.value=!0),l.value>1?t.value=t.value.concat(a.list):(t.value=a.list||[],window.scrollTo(0,0)),v.value=Math.ceil(a.pager.total_rows/w.value),b.value=t.value,Y.value=v.value}).catch(a=>{t.value=[],l.value>1&&l.value--,p.value=!1})},Z=()=>{p.value=!0,N({username:P.value,style:"comment",page:l.value,page_size:w.value}).then(a=>{p.value=!1,a.list.length===0&&(h.value=!0),l.value>1?t.value=t.value.concat(a.list):(t.value=a.list||[],window.scrollTo(0,0)),v.value=Math.ceil(a.pager.total_rows/w.value),F.value=t.value,J.value=v.value}).catch(a=>{t.value=[],l.value>1&&l.value--,p.value=!1})},ee=()=>{p.value=!0,N({username:P.value,style:"highlight",page:l.value,page_size:w.value}).then(a=>{p.value=!1,a.list.length===0&&(h.value=!0),l.value>1?t.value=t.value.concat(a.list):(t.value=a.list||[],window.scrollTo(0,0)),v.value=Math.ceil(a.pager.total_rows/w.value),C.value=t.value,K.value=v.value}).catch(a=>{t.value=[],l.value>1&&l.value--,p.value=!1})},ae=()=>{p.value=!0,N({username:P.value,style:"media",page:l.value,page_size:w.value}).then(a=>{p.value=!1,a.list.length===0&&(h.value=!0),l.value>1?t.value=t.value.concat(a.list):(t.value=a.list||[],window.scrollTo(0,0)),v.value=Math.ceil(a.pager.total_rows/w.value),L.value=t.value,Q.value=v.value}).catch(a=>{t.value=[],l.value>1&&l.value--,p.value=!1})},te=()=>{p.value=!0,N({username:P.value,style:"star",page:l.value,page_size:w.value}).then(a=>{p.value=!1,a.list.length===0&&(h.value=!0),l.value>1?t.value=t.value.concat(a.list):(t.value=a.list||[],window.scrollTo(0,0)),v.value=Math.ceil(a.pager.total_rows/w.value),U.value=t.value,X.value=v.value}).catch(a=>{t.value=[],l.value>1&&l.value--,p.value=!1})},Pe=a=>{switch(T.value=a,T.value){case"post":t.value=b.value,l.value=D.value,v.value=Y.value,E();break;case"comment":t.value=F.value,l.value=W.value,v.value=J.value,Z();break;case"highlight":t.value=C.value,l.value=A.value,v.value=K.value,ee();break;case"media":t.value=L.value,l.value=x.value,v.value=Q.value,ae();break;case"star":t.value=U.value,l.value=H.value,v.value=X.value,te();break}},j=()=>{_.value=!0,za({username:P.value}).then(a=>{_.value=!1,e.id=a.id,e.avatar=a.avatar,e.username=a.username,e.nickname=a.nickname,e.is_admin=a.is_admin,e.is_friend=a.is_friend,e.created_on=a.created_on,e.is_following=a.is_following,e.follows=a.follows,e.followings=a.followings,e.status=a.status,be()}).catch(a=>{_.value=!1,console.log(a)})},$e=()=>{switch(T.value){case"post":D.value=l.value,E();break;case"comment":W.value=l.value,Z();break;case"highlight":A.value=l.value,ee();break;case"media":x.value=l.value,ae();break;case"star":H.value=l.value,te();break}},Te=()=>{O.value=!0},xe=()=>{i.value=!0},ze=()=>{O.value=!1},qe=()=>{i.value=!1},M=a=>()=>G(I,null,{default:()=>G(a)}),Ce=le(()=>{let a=[{label:"私信",key:"whisper",icon:M(ra)}];return y.state.userInfo.is_admin&&(e.status===1?a.push({label:"禁言",key:"banned",icon:M(_e)}):a.push({label:"解封",key:"deblocking",icon:M(_e)})),e.is_following?a.push({label:"取消关注",key:"unfollow",icon:M(_a)}):a.push({label:"关注",key:"follow",icon:M(va)}),V&&(e.is_friend?a.push({label:"删除好友",key:"delete",icon:M(pa)}):a.push({label:"添加朋友",key:"requesting",icon:M(ma)})),a}),Me=a=>{switch(a){case"whisper":Te();break;case"delete":Ie();break;case"requesting":xe();break;case"follow":case"unfollow":Se();break;case"banned":case"deblocking":Oe();break}},Ie=()=>{q.warning({title:"删除好友",content:"将好友 “"+e.nickname+"” 删除，将同时删除 点赞/收藏 列表中关于该朋友的 “好友可见” 推文",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{_.value=!0,qa({user_id:e.id}).then(a=>{_.value=!1,e.is_friend=!1,E()}).catch(a=>{_.value=!1,console.log(a)})}})},Se=()=>{q.success({title:"提示",content:"确定"+(e.is_following?"取消关注":"关注")+"该用户吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{_.value=!0,e.is_following?Ca({user_id:e.id}).then(a=>{_.value=!1,window.$message.success("取消关注成功"),j()}).catch(a=>{_.value=!1,console.log(a)}):Ma({user_id:e.id}).then(a=>{_.value=!1,window.$message.success("关注成功"),j()}).catch(a=>{_.value=!1,console.log(a)})}})},Oe=()=>{q.warning({title:"警告",content:"确定对该用户进行"+(e.status===1?"禁言":"解封")+"处理吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{_.value=!0,Ia({id:e.id,status:e.status===1?2:1}).then(a=>{_.value=!1,e.status===1?window.$message.success("禁言成功"):window.$message.success("解封成功"),j()}).catch(a=>{_.value=!1,console.log(a)})}})},Fe=()=>{l.value<v.value||v.value==0?(h.value=!1,l.value++,$e()):h.value=!0};return Ze(()=>{j()}),ea(()=>({path:$.path,query:$.query}),(a,z)=>{z.path==="/m"&&a.path==="/m"&&(P.value=$.query.s||"",ye(),j())}),(a,z)=>{const Le=fe,se=ge,ie=pe("router-link"),Ue=he,De=ke,We=xa,ce=ha,B=ka,Ae=wa,He=$a,je=ya,Be=Pa,re=ba,Ne=Ba,Re=ga,Ve=we;return n(),g("div",null,[s(Re,{class:"main-content-wrap profile-wrap",bordered:""},{default:o(()=>[s(ce,{show:_.value},{default:o(()=>[e.id>0?(n(),g("div",Na,[c("div",Ra,[s(Le,{size:72,src:e.avatar},null,8,["src"])]),c("div",Va,[c("div",Ea,[c("strong",null,f(e.nickname),1),c("span",null," @"+f(e.username),1),V&&r(y).state.userInfo.id>0&&r(y).state.userInfo.username!=e.username&&e.is_friend?(n(),d(se,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:o(()=>[k(" 好友 ")]),_:1})):m("",!0),r(y).state.userInfo.id>0&&r(y).state.userInfo.username!=e.username&&e.is_following?(n(),d(se,{key:1,class:"top-tag",type:"success",size:"small",round:""},{default:o(()=>[k(" 已关注 ")]),_:1})):m("",!0),e.is_admin?(n(),d(se,{key:2,class:"top-tag",type:"error",size:"small",round:""},{default:o(()=>[k(" 管理员 ")]),_:1})):m("",!0)]),c("div",Ga,[c("span",Ya,"UID. "+f(e.id),1),c("span",Ja,f(r(la)(e.created_on))+" 加入",1)]),c("div",Ka,[c("span",Qa,[s(ie,{onClick:z[0]||(z[0]=R(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:e.username,n:e.nickname,t:"follows"}}},{default:o(()=>[k(" 关注  "+f(e.follows),1)]),_:1},8,["to"])]),c("span",Xa,[s(ie,{onClick:z[1]||(z[1]=R(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:e.username,n:e.nickname,t:"followings"}}},{default:o(()=>[k(" 粉丝  "+f(e.followings),1)]),_:1},8,["to"])])])]),r(y).state.userInfo.id>0&&r(y).state.userInfo.username!=e.username?(n(),g("div",Za,[s(De,{placement:"bottom-end",trigger:"click",size:"small",options:Ce.value,onSelect:Me},{default:o(()=>[s(Ue,{quaternary:"",circle:""},{icon:o(()=>[s(r(I),null,{default:o(()=>[s(r(de))]),_:1})]),_:1})]),_:1},8,["options"])])):m("",!0)])):m("",!0),s(We,{show:O.value,user:e,onSuccess:ze},null,8,["show","user"]),s(Ta,{show:i.value,user:e,onSuccess:qe},null,8,["show","user"])]),_:1},8,["show"]),s(Ae,{class:"profile-tabs-wrap",type:"line",animated:"",value:T.value,"onUpdate:value":Pe},{default:o(()=>[s(B,{name:"post",tab:"泡泡"}),s(B,{name:"comment",tab:"评论"}),s(B,{name:"highlight",tab:"亮点"}),s(B,{name:"media",tab:"图文"}),s(B,{name:"star",tab:"喜欢"})]),_:1},8,["value"]),p.value&&t.value.length===0?(n(),g("div",et,[s(He,{num:w.value},null,8,["num"])])):(n(),g("div",at,[t.value.length===0?(n(),g("div",tt,[s(je,{size:"large",description:"暂无数据"})])):m("",!0),r(y).state.desktopModelShow?(n(),g("div",st,[(n(!0),g(oe,null,ne(t.value,S=>(n(),d(re,{key:S.id},{default:o(()=>[s(Be,{post:S},null,8,["post"])]),_:2},1024))),128))])):(n(),g("div",lt,[(n(!0),g(oe,null,ne(t.value,S=>(n(),d(re,{key:S.id},{default:o(()=>[s(Ne,{post:S},null,8,["post"])]),_:2},1024))),128))]))]))]),_:1}),v.value>0?(n(),d(Ve,{key:0,justify:"center"},{default:o(()=>[s(r(Oa),{class:"load-more",slots:{complete:"没有更多泡泡了",error:"加载出错"},onInfinite:z[2]||(z[2]=S=>Fe())},{spinner:o(()=>[c("div",ot,[h.value?m("",!0):(n(),d(ce,{key:0,size:14})),c("span",nt,f(h.value?"没有更多泡泡了":"加载更多"),1)])]),_:1})]),_:1})):m("",!0)])}}});const Ht=Sa(ut,[["__scopeId","data-v-f524c028"]]);export{Ht as default};
