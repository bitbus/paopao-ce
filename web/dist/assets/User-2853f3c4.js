import{_ as Le}from"./mobile-post-item.vue_vue_type_style_index_0_lang-6c05e238.js";import{_ as Oe}from"./post-item.vue_vue_type_style_index_0_lang-8dc18a9d.js";import{_ as De}from"./post-skeleton-ce58098c.js";import{W as Ae,_ as Be}from"./whisper-add-friend-6ba3ad66.js";import{_ as Ne}from"./main-nav.vue_vue_type_style_index_0_lang-be38284d.js";import{d as He,H as l,R as Re,c as Ve,b as je,E as Ee,r as Ge,f as d,k as o,w as r,q as b,Y as h,e as u,j as v,x as y,bf as m,A as F,y as le,F as oe,u as ne,h as ue}from"./@vue-a481fc63.js";import{u as Ye}from"./vuex-44de225f.js";import{b as Je}from"./vue-router-e5a2430e.js";import{D as Ke,e as I,E as Qe,F as Xe,G as Ze,H as ea,_ as aa}from"./index-27f06e6c.js";import{b as sa}from"./formatTime-4210fcd1.js";import{W as ta}from"./v3-infinite-loading-2c58ec2f.js";import{R as la,F as oa,a as na,j as ie,o as ua,M as ia,e as ca,O as ra,k as va,f as _a,g as ma,I as pa,G as da}from"./naive-ui-0c25505f.js";import{i as fa,w as ga,x as ce,y as ha,z as wa,D as ka,G as ba}from"./@vicons-9939c40b.js";import"./content-7dbf66ba.js";import"./paopao-video-player-2fe58954.js";import"./copy-to-clipboard-4ef7d3eb.js";import"./@babel-725317a4.js";import"./toggle-selection-93f4ad84.js";import"./vooks-6d99783e.js";import"./evtd-b614532e.js";import"./axios-4a70c6fc.js";/* empty css               */import"./seemly-76b7b838.js";import"./vueuc-39372edb.js";import"./@css-render-7124a1a5.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-6a5c5852.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-8412e618.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";import"./moment-2ab8298d.js";const ya={key:0,class:"profile-baseinfo"},Pa={class:"avatar"},Ta={class:"base-info"},xa={class:"username"},za={class:"userinfo"},Ua={class:"info-item"},Fa={class:"info-item"},Ia={class:"userinfo"},$a={class:"info-item"},qa={class:"info-item"},Ca={key:0,class:"user-opts"},Ma={key:0,class:"skeleton-wrap"},Sa={key:1},Wa={key:0,class:"empty-wrap"},La={key:1},Oa={key:2},Da={class:"load-more-wrap"},Aa={class:"load-more-spinner"},Ba=He({__name:"User",setup(Na){const q=la(),f=Ye(),P=Je(),ee="true".toLowerCase()==="true",i=l(!1),p=l(!1),a=Re({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,is_following:!1,created_on:0,follows:0,followings:0,status:1}),c=l(!1),C=l(!1),M=l(!1),s=l([]),S=l([]),W=l([]),L=l([]),O=l([]),D=l([]),w=l(P.query.s||""),t=l(+P.query.p||1),T=l("post"),A=l(+P.query.p||1),B=l(1),N=l(1),H=l(1),R=l(1),_=l(20),n=l(0),V=l(0),j=l(0),E=l(0),G=l(0),Y=l(0),re=()=>{p.value=!1,s.value=[],S.value=[],W.value=[],L.value=[],O.value=[],D.value=[],T.value="post",t.value=1,A.value=1,B.value=1,N.value=1,H.value=1,R.value=1,n.value=0,V.value=0,j.value=0,E.value=0,G.value=0,Y.value=0},ve=()=>{switch(T.value){case"post":$();break;case"comment":J();break;case"highlight":K();break;case"media":Q();break;case"star":X();break}},$=()=>{i.value=!0,I({username:w.value,style:"post",page:t.value,page_size:_.value}).then(e=>{i.value=!1,e.list.length===0&&(p.value=!0),t.value>1?s.value=s.value.concat(e.list):(s.value=e.list||[],window.scrollTo(0,0)),n.value=Math.ceil(e.pager.total_rows/_.value),S.value=s.value,V.value=n.value}).catch(e=>{s.value=[],t.value>1&&t.value--,i.value=!1})},J=()=>{i.value=!0,I({username:w.value,style:"comment",page:t.value,page_size:_.value}).then(e=>{i.value=!1,e.list.length===0&&(p.value=!0),t.value>1?s.value=s.value.concat(e.list):(s.value=e.list||[],window.scrollTo(0,0)),n.value=Math.ceil(e.pager.total_rows/_.value),W.value=s.value,j.value=n.value}).catch(e=>{s.value=[],t.value>1&&t.value--,i.value=!1})},K=()=>{i.value=!0,I({username:w.value,style:"highlight",page:t.value,page_size:_.value}).then(e=>{i.value=!1,e.list.length===0&&(p.value=!0),t.value>1?s.value=s.value.concat(e.list):(s.value=e.list||[],window.scrollTo(0,0)),n.value=Math.ceil(e.pager.total_rows/_.value),L.value=s.value,E.value=n.value}).catch(e=>{s.value=[],t.value>1&&t.value--,i.value=!1})},Q=()=>{i.value=!0,I({username:w.value,style:"media",page:t.value,page_size:_.value}).then(e=>{i.value=!1,e.list.length===0&&(p.value=!0),t.value>1?s.value=s.value.concat(e.list):(s.value=e.list||[],window.scrollTo(0,0)),n.value=Math.ceil(e.pager.total_rows/_.value),O.value=s.value,G.value=n.value}).catch(e=>{s.value=[],t.value>1&&t.value--,i.value=!1})},X=()=>{i.value=!0,I({username:w.value,style:"star",page:t.value,page_size:_.value}).then(e=>{i.value=!1,e.list.length===0&&(p.value=!0),t.value>1?s.value=s.value.concat(e.list):(s.value=e.list||[],window.scrollTo(0,0)),n.value=Math.ceil(e.pager.total_rows/_.value),D.value=s.value,Y.value=n.value}).catch(e=>{s.value=[],t.value>1&&t.value--,i.value=!1})},_e=e=>{switch(T.value=e,T.value){case"post":s.value=S.value,t.value=A.value,n.value=V.value,$();break;case"comment":s.value=W.value,t.value=B.value,n.value=j.value,J();break;case"highlight":s.value=L.value,t.value=N.value,n.value=E.value,K();break;case"media":s.value=O.value,t.value=H.value,n.value=G.value,Q();break;case"star":s.value=D.value,t.value=R.value,n.value=Y.value,X();break}},z=()=>{c.value=!0,Ke({username:w.value}).then(e=>{c.value=!1,a.id=e.id,a.avatar=e.avatar,a.username=e.username,a.nickname=e.nickname,a.is_admin=e.is_admin,a.is_friend=e.is_friend,a.created_on=e.created_on,a.is_following=e.is_following,a.follows=e.follows,a.followings=e.followings,a.status=e.status,ve()}).catch(e=>{c.value=!1,console.log(e)})},me=()=>{switch(T.value){case"post":A.value=t.value,$();break;case"comment":B.value=t.value,J();break;case"highlight":N.value=t.value,K();break;case"media":H.value=t.value,Q();break;case"star":R.value=t.value,X();break}},pe=()=>{C.value=!0},de=()=>{M.value=!0},fe=()=>{C.value=!1},ge=()=>{M.value=!1},k=e=>()=>ue(ie,null,{default:()=>ue(e)}),he=Ve(()=>{let e=[{label:"私信",key:"whisper",icon:k(ga)}];return f.state.userInfo.is_admin&&(a.status===1?e.push({label:"禁言",key:"banned",icon:k(ce)}):e.push({label:"解封",key:"deblocking",icon:k(ce)})),a.is_following?e.push({label:"取消关注",key:"unfollow",icon:k(ha)}):e.push({label:"关注",key:"follow",icon:k(wa)}),ee&&(a.is_friend?e.push({label:"删除好友",key:"delete",icon:k(ka)}):e.push({label:"添加朋友",key:"requesting",icon:k(ba)})),e}),we=e=>{switch(e){case"whisper":pe();break;case"delete":ke();break;case"requesting":de();break;case"follow":case"unfollow":be();break;case"banned":case"deblocking":ye();break}},ke=()=>{q.warning({title:"删除好友",content:"将好友 “"+a.nickname+"” 删除，将同时删除 点赞/收藏 列表中关于该朋友的 “好友可见” 推文",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{c.value=!0,Qe({user_id:a.id}).then(e=>{c.value=!1,a.is_friend=!1,$()}).catch(e=>{c.value=!1,console.log(e)})}})},be=()=>{q.success({title:"提示",content:"确定"+(a.is_following?"取消关注":"关注")+"该用户吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{c.value=!0,a.is_following?Xe({user_id:a.id}).then(e=>{c.value=!1,window.$message.success("取消关注成功"),z()}).catch(e=>{c.value=!1,console.log(e)}):Ze({user_id:a.id}).then(e=>{c.value=!1,window.$message.success("关注成功"),z()}).catch(e=>{c.value=!1,console.log(e)})}})},ye=()=>{q.warning({title:"警告",content:"确定对该用户进行"+(a.status===1?"禁言":"解封")+"处理吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{c.value=!0,ea({id:a.id,status:a.status===1?2:1}).then(e=>{c.value=!1,a.status===1?window.$message.success("禁言成功"):window.$message.success("解封成功"),z()}).catch(e=>{c.value=!1,console.log(e)})}})},Pe=()=>{t.value<n.value||n.value==0?(p.value=!1,t.value++,me()):p.value=!0};return je(()=>{z()}),Ee(()=>({path:P.path,query:P.query}),(e,g)=>{g.path==="/u"&&e.path==="/u"&&(w.value=P.query.s||"",re(),z())}),(e,g)=>{const Te=Ne,xe=ua,Z=ia,ae=Ge("router-link"),ze=ca,Ue=ra,Fe=Be,se=va,U=_a,Ie=ma,$e=De,qe=pa,Ce=Oe,te=da,Me=Le,Se=oa,We=na;return u(),d("div",null,[o(Te,{title:"用户详情"}),o(Se,{class:"main-content-wrap profile-wrap",bordered:""},{default:r(()=>[o(se,{show:c.value},{default:r(()=>[a.id>0?(u(),d("div",ya,[v("div",Pa,[o(xe,{size:72,src:a.avatar},null,8,["src"])]),v("div",Ta,[v("div",xa,[v("strong",null,y(a.nickname),1),v("span",null," @"+y(a.username),1),ee&&m(f).state.userInfo.id>0&&m(f).state.userInfo.username!=a.username&&a.is_friend?(u(),b(Z,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:r(()=>[F(" 好友 ")]),_:1})):h("",!0),m(f).state.userInfo.id>0&&m(f).state.userInfo.username!=a.username&&a.is_following?(u(),b(Z,{key:1,class:"top-tag",type:"success",size:"small",round:""},{default:r(()=>[F(" 已关注 ")]),_:1})):h("",!0),a.is_admin?(u(),b(Z,{key:2,class:"top-tag",type:"error",size:"small",round:""},{default:r(()=>[F(" 管理员 ")]),_:1})):h("",!0)]),v("div",za,[v("span",Ua,"UID. "+y(a.id),1),v("span",Fa,y(m(sa)(a.created_on))+" 加入",1)]),v("div",Ia,[v("span",$a,[o(ae,{onClick:g[0]||(g[0]=le(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:a.username,n:a.nickname,t:"follows"}}},{default:r(()=>[F(" 关注  "+y(a.follows),1)]),_:1},8,["to"])]),v("span",qa,[o(ae,{onClick:g[1]||(g[1]=le(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:a.username,n:a.nickname,t:"followings"}}},{default:r(()=>[F(" 粉丝  "+y(a.followings),1)]),_:1},8,["to"])])])]),m(f).state.userInfo.id>0&&m(f).state.userInfo.username!=a.username?(u(),d("div",Ca,[o(Ue,{placement:"bottom-end",trigger:"click",size:"small",options:he.value,onSelect:we},{default:r(()=>[o(ze,{quaternary:"",circle:""},{icon:r(()=>[o(m(ie),null,{default:r(()=>[o(m(fa))]),_:1})]),_:1})]),_:1},8,["options"])])):h("",!0)])):h("",!0),o(Fe,{show:C.value,user:a,onSuccess:fe},null,8,["show","user"]),o(Ae,{show:M.value,user:a,onSuccess:ge},null,8,["show","user"])]),_:1},8,["show"]),o(Ie,{class:"profile-tabs-wrap",type:"line",animated:"",value:T.value,"onUpdate:value":_e},{default:r(()=>[o(U,{name:"post",tab:"泡泡"}),o(U,{name:"comment",tab:"评论"}),o(U,{name:"highlight",tab:"亮点"}),o(U,{name:"media",tab:"图文"}),o(U,{name:"star",tab:"喜欢"})]),_:1},8,["value"]),i.value&&s.value.length===0?(u(),d("div",Ma,[o($e,{num:_.value},null,8,["num"])])):(u(),d("div",Sa,[s.value.length===0?(u(),d("div",Wa,[o(qe,{size:"large",description:"暂无数据"})])):h("",!0),m(f).state.desktopModelShow?(u(),d("div",La,[(u(!0),d(oe,null,ne(s.value,x=>(u(),b(te,{key:x.id},{default:r(()=>[o(Ce,{post:x},null,8,["post"])]),_:2},1024))),128))])):(u(),d("div",Oa,[(u(!0),d(oe,null,ne(s.value,x=>(u(),b(te,{key:x.id},{default:r(()=>[o(Me,{post:x},null,8,["post"])]),_:2},1024))),128))]))]))]),_:1}),n.value>0?(u(),b(We,{key:0,justify:"center"},{default:r(()=>[o(m(ta),{class:"load-more",slots:{complete:"没有更多泡泡了",error:"加载出错"},onInfinite:g[2]||(g[2]=x=>Pe())},{spinner:r(()=>[v("div",Da,[p.value?h("",!0):(u(),b(se,{key:0,size:14})),v("span",Aa,y(p.value?"没有更多泡泡了":"加载更多"),1)])]),_:1})]),_:1})):h("",!0)])}}});const ys=aa(Ba,[["__scopeId","data-v-7741b862"]]);export{ys as default};
